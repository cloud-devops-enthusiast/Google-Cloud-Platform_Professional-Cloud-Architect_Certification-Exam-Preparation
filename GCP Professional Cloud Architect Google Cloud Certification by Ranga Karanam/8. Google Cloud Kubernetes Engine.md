**Google Kubernetes Engine (GKE)**

- Most popular container orchestration platform.
- Provides a cluster management (including upgardes).
  - Each cluster can have different types of virtual machines.
- Provides all important container orchestration features.
  - Auto Scaling
  - Service Discovery
  - Load Balancer
  - Self Healing
  - Zero Downtime Deployment
- This is a managed kubernetes service.
- Minimize operations with auto-repair(repair failed nodes) and auto-upgrade(use latest version of kubernetes) features.
- Provides pod and cluster autoscaling.
- Enable cloud logging and cloud monitoring with simple configuration.
- Uses container-optimized OS, a hardened os built by Google.
- Provides support for persistent disks and local SSDs.

**Kubernetes-A Microservice Journey**

1: Create a kubernetes cluster with the default node pool.
- Here you can use the command *gcloud container clusters create* or use cloud console for creating a cluster.
2: There are two modes of kubernetes clusters:
- Standard cluster: Kubernetes cluster with node configuration flexibility and pay-per-node.
- Autopilot Cluster: Optimized kubernetes cluster with a hands-off experience and pay-per-pod.
  - New mode of operation for GKE.
  - Reduce your operational costs in running Kubernetes clusters.
  - Provides an hands-off experience:
    - Do not worry about managing the cluster infrastructure(nodes, node pools..).
    - GKE will manage the clusters for you.

**Kubernetes Commands**

- For creating standard cluster:
  * Set the default project:
    - gcloud config set project {project-id}
  * Connect to the Kubernetes cluster
    - gcloud container clusters create get-credentials {cluster-name} -- zone us-central1-a --project {project-id}
  * Deploy microservice to kubernetes:
    * Create deployment and service using kubectl commands:
      - kubectl create deployment hello-world-rest-api --image=in28min/hello-world-rest-api:0.0.1.RELEASE
**kubectl is a kubernetes specific command, and this is a cloud neutral command.**
  * Check the deployment:
    - kubectl get deployment
  * Expose the deployment via the loadbalancer:
    - kubectl expose deployment hello-world-rest-api --type=LoadBalancer --port=8080
  * Look at the status of the services:
    - kubectl get services
  * To continously monitor the status of the pods:
    - kubectl get services --watch
  * Sending curl or get request to the service:
    - curl 35.184.204.214:8080/hello-world
**You can add multiple node pools to your cluster.**
  * To see what is happening with your clusters:
    - kubectl get events
  * **Services**: Services are sets of pods with a network endpoint that can be used for discovery and load balancing.
  * **Ingress**: Ingresses are collections of rules for routing external traffic to services.
  * Increasing number of instances for your microservice:
    - kubectl scale deployment {deployment-name} --replicas=3
    - kubectl scale deployment hello-world-rest-api --replicas=3
  * Increase number of nodes in your kubernetes cluster:
    - gcloud container clusters resize my-cluster --node-pool default-pool --num-nodes=2 --zone=us-central1-c
  - kubectl autoscale deployment hello-world-rest-api --max=4 --cpu-percent=70
  - kubectl get hpa
  - kubectl create configmap hello-world-config --from-literal=RDS_DB_NAME=todos
  - kubectl get configmap
  - kubectl describe configmap hello-world-config
  - kubectl create secret generic hello-world-secrets-1 --from-literal=RDS_PASSWORD=dummytodos
  - kubectl get secret
  - kubectl describe secret hello-world-secrets-1
  - kubectl apply -f deployment.yaml
  - gcloud container node-pools list --zone=us-central1-c --cluster=my-cluster
  - kubectl get pods -o wide
  - kubectl set image deployment hello-world-rest-api hello-world-rest-api=in28min/hello-world-rest-api:0.0.2.RELEASE
  - kubectl get services
  - kubectl get replicasets
  - kubectl get pods
  - kubectl delete pod hello-world-rest-api-58dc9d7fcc-8pv7r
  - kubectl scale deployment hello-world-rest-api --replicas=1
  - kubectl get replicasets
  - gcloud projects list
  - kubectl delete service hello-world-rest-api
  - kubectl delete deployment hello-world-rest-api
  - gcloud container clusters delete my-cluster --zone us-central1-c
